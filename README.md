This project implements a real-time traffic-light control system where a Raspberry Pi dynamically generates traffic stage data and transmits it to an STM32F407 microcontroller over UART. The Raspberry Pi processes a JSON configuration file that contains the traffic stage information—such as active light patterns, timing durations for each phase, and additional control flags—and encodes this into a compact binary packet format. This packet is streamed to the STM32, where data is received byte-by-byte using UART interrupts. The USART6 interrupt handler ensures that every incoming byte is immediately captured in the receive buffer without loss, even when data is transmitted as fast as every 1–10 ms.

This received packet is then processed by the StartPacketProcessor FreeRTOS task, which extracts the stage patterns, timing durations, and other fields from the decoded binary format. The decoded values are stored in shared variables protected by FreeRTOS mutexes to avoid data corruption. Once valid schedule data is available, the system enters active control mode, where the StartLEDController task drives GPIO outputs to control LEDs representing traffic signals. Each LED state is set according to the bit-mapped stage pattern received from the Raspberry Pi.

A FreeRTOS timer is used to manage precise timing of each stage duration. When a stage expires, the timer triggers a task notification, signaling the LED controller to advance to the next scheduled stage. UART priority is explicitly increased at NVIC level so that UART interrupts always pre-empt other tasks, ensuring reliable reception even under heavy RTOS activity. The result is a fast, efficient, interrupt-driven system capable of handling high-frequency serial input while maintaining real-time output control for physical traffic indicators.
